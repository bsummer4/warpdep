<!DOCTYPE html>
<html>
  <head>
    <title>wai-app-static/WaiAppStatic/Listing.hs</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../srcco.css">
    <script src="../../srcco.js"></script>
  </head>
  <body>
    <div class="tocs">
      <div id="files" class="toc-name">
        files
      </div>
      <div id="defs" class="toc-name">
        defs
      </div>
      <div id="files-toc" class="toc">
        <div class="node" level=0><div class="node-title"><i class="fa fa-angle-right carrot"></i> all files</div>
<div class="node-body"><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> auto-update</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Control</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> AutoUpdate</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../auto-update/Control/AutoUpdate/Util.hs.html">Util.hs</a></div></div></div><div class="node-path"><a class="file" href="../../auto-update/Control/AutoUpdate.hs.html">AutoUpdate.hs</a></div><div class="node-path"><a class="file" href="../../auto-update/Control/Debounce.hs.html">Debounce.hs</a></div><div class="node-path"><a class="file" href="../../auto-update/Control/Reaper.hs.html">Reaper.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> test</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Control</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../auto-update/test/Control/AutoUpdateSpec.hs.html">AutoUpdateSpec.hs</a></div><div class="node-path"><a class="file" href="../../../auto-update/test/Control/ReaperSpec.hs.html">ReaperSpec.hs</a></div></div></div><div class="node-path"><a class="file" href="../../auto-update/test/Spec.hs.html">Spec.hs</a></div></div></div><div class="node-path"><a class="file" href="../auto-update/Setup.hs.html">Setup.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> mime-types</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../mime-types/Network/Mime.hs.html">Mime.hs</a></div></div></div><div class="node-path"><a class="file" href="../mime-types/Setup.lhs.html">Setup.lhs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../wai/Network/Wai/Internal.hs.html">Internal.hs</a></div></div></div><div class="node-path"><a class="file" href="../../wai/Network/Wai.hs.html">Wai.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> test</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../wai/test/Network/WaiSpec.hs.html">WaiSpec.hs</a></div></div></div><div class="node-path"><a class="file" href="../../wai/test/Spec.hs.html">Spec.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> webkit-sample</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../wai/webkit-sample/webkit-sample.hs.html">webkit-sample.hs</a></div></div></div><div class="node-path"><a class="file" href="../wai/Setup.lhs.html">Setup.lhs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-app-static</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> WaiAppStatic</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Storage</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Embedded</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-app-static/WaiAppStatic/Storage/Embedded/Runtime.hs.html">Runtime.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-app-static/WaiAppStatic/Storage/Embedded/TH.hs.html">TH.hs</a></div></div></div><div class="node-path"><a class="file" href="../../../wai-app-static/WaiAppStatic/Storage/Embedded.hs.html">Embedded.hs</a></div><div class="node-path"><a class="file" href="../../../wai-app-static/WaiAppStatic/Storage/Filesystem.hs.html">Filesystem.hs</a></div></div></div><div class="node-path"><a class="file" href="../../wai-app-static/WaiAppStatic/CmdLine.hs.html">CmdLine.hs</a></div><div class="node-path"><a class="file" href="../../wai-app-static/WaiAppStatic/Listing.hs.html">Listing.hs</a></div><div class="node-path"><a class="file" href="../../wai-app-static/WaiAppStatic/Types.hs.html">Types.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> test</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../wai-app-static/test/EmbeddedTestEntries.hs.html">EmbeddedTestEntries.hs</a></div><div class="node-path"><a class="file" href="../../wai-app-static/test/WaiAppEmbeddedTest.hs.html">WaiAppEmbeddedTest.hs</a></div><div class="node-path"><a class="file" href="../../wai-app-static/test/WaiAppStaticTest.hs.html">WaiAppStaticTest.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Application</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-app-static/Network/Wai/Application/Static.hs.html">Static.hs</a></div></div></div></div></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> app</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../wai-app-static/app/warp-static.hs.html">warp-static.hs</a></div></div></div><div class="node-path"><a class="file" href="../wai-app-static/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-app-static/Util.hs.html">Util.hs</a></div><div class="node-path"><a class="file" href="../wai-app-static/embedded-sample.hs.html">embedded-sample.hs</a></div><div class="node-path"><a class="file" href="../wai-app-static/sample.hs.html">sample.hs</a></div><div class="node-path"><a class="file" href="../wai-app-static/tests.hs.html">tests.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-conduit</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../wai-conduit/Network/Wai/Conduit.hs.html">Conduit.hs</a></div></div></div></div></div><div class="node-path"><a class="file" href="../wai-conduit/Setup.hs.html">Setup.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-extra</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Middleware</div>
<div class="node-body"><div class="node" level=5><div class="node-title"><i class="fa fa-angle-right carrot"></i> RequestLogger</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../../wai-extra/Network/Wai/Middleware/RequestLogger/Internal.hs.html">Internal.hs</a></div></div></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/AcceptOverride.hs.html">AcceptOverride.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/AddHeaders.hs.html">AddHeaders.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Autohead.hs.html">Autohead.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/CleanPath.hs.html">CleanPath.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Gzip.hs.html">Gzip.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/HttpAuth.hs.html">HttpAuth.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Jsonp.hs.html">Jsonp.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Local.hs.html">Local.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/MethodOverride.hs.html">MethodOverride.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/MethodOverridePost.hs.html">MethodOverridePost.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/RequestLogger.hs.html">RequestLogger.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Rewrite.hs.html">Rewrite.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/StreamFile.hs.html">StreamFile.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Middleware/Vhost.hs.html">Vhost.hs</a></div></div></div><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Handler/CGI.hs.html">CGI.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/Handler/SCGI.hs.html">SCGI.hs</a></div></div></div><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> EventSource</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-extra/Network/Wai/EventSource/EventStream.hs.html">EventStream.hs</a></div></div></div><div class="node-path"><a class="file" href="../../../wai-extra/Network/Wai/EventSource.hs.html">EventSource.hs</a></div><div class="node-path"><a class="file" href="../../../wai-extra/Network/Wai/Parse.hs.html">Parse.hs</a></div><div class="node-path"><a class="file" href="../../../wai-extra/Network/Wai/Test.hs.html">Test.hs</a></div><div class="node-path"><a class="file" href="../../../wai-extra/Network/Wai/UrlMap.hs.html">UrlMap.hs</a></div></div></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> app</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../wai-extra/app/Main.hs.html">Main.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> test</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-extra/test/Network/Wai/ParseSpec.hs.html">ParseSpec.hs</a></div><div class="node-path"><a class="file" href="../../../../wai-extra/test/Network/Wai/TestSpec.hs.html">TestSpec.hs</a></div></div></div></div></div><div class="node-path"><a class="file" href="../../wai-extra/test/Spec.hs.html">Spec.hs</a></div><div class="node-path"><a class="file" href="../../wai-extra/test/WaiExtraSpec.hs.html">WaiExtraSpec.hs</a></div><div class="node-path"><a class="file" href="../../wai-extra/test/sample.hs.html">sample.hs</a></div></div></div><div class="node-path"><a class="file" href="../wai-extra/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-extra/proxy.hs.html">proxy.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-frontend-monadcgi</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Frontend</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-frontend-monadcgi/Network/Wai/Frontend/MonadCGI.hs.html">MonadCGI.hs</a></div></div></div></div></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> samples</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../wai-frontend-monadcgi/samples/plain_cgi.hs.html">plain_cgi.hs</a></div><div class="node-path"><a class="file" href="../../wai-frontend-monadcgi/samples/wai_cgi.hs.html">wai_cgi.hs</a></div><div class="node-path"><a class="file" href="../../wai-frontend-monadcgi/samples/wai_cgi_generic.hs.html">wai_cgi_generic.hs</a></div><div class="node-path"><a class="file" href="../../wai-frontend-monadcgi/samples/wai_fastcgi.hs.html">wai_fastcgi.hs</a></div></div></div><div class="node-path"><a class="file" href="../wai-frontend-monadcgi/Setup.lhs.html">Setup.lhs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-handler-fastcgi</div>
<div class="node-body"><div class="node-path"><a class="file" href="../wai-handler-fastcgi/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-handler-fastcgi/test.hs.html">test.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-handler-launch</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-handler-launch/Network/Wai/Handler/Launch.hs.html">Launch.hs</a></div></div></div></div></div></div></div><div class="node-path"><a class="file" href="../wai-handler-launch/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-handler-launch/runtests.hs.html">runtests.hs</a></div><div class="node-path"><a class="file" href="../wai-handler-launch/test.hs.html">test.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-handler-webkit</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-handler-webkit/Network/Wai/Handler/Webkit.hs.html">Webkit.hs</a></div></div></div></div></div></div></div><div class="node-path"><a class="file" href="../wai-handler-webkit/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-handler-webkit/sample.hs.html">sample.hs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-websockets</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../wai-websockets/Network/Wai/Handler/WebSockets.hs.html">WebSockets.hs</a></div></div></div></div></div></div></div><div class="node-path"><a class="file" href="../wai-websockets/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../wai-websockets/server.lhs.html">server.lhs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> warp</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node" level=5><div class="node-title"><i class="fa fa-angle-right carrot"></i> Warp</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Buffer.hs.html">Buffer.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Conduit.hs.html">Conduit.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Counter.hs.html">Counter.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Date.hs.html">Date.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/FdCache.hs.html">FdCache.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Header.hs.html">Header.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/IO.hs.html">IO.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/IORef.hs.html">IORef.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Internal.hs.html">Internal.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/MultiMap.hs.html">MultiMap.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/ReadInt.hs.html">ReadInt.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Recv.hs.html">Recv.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Request.hs.html">Request.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/RequestHeader.hs.html">RequestHeader.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Response.hs.html">Response.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/ResponseHeader.hs.html">ResponseHeader.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Run.hs.html">Run.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/SendFile.hs.html">SendFile.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Settings.hs.html">Settings.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Timeout.hs.html">Timeout.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Types.hs.html">Types.hs</a></div><div class="node-path"><a class="file" href="../../../../../warp/Network/Wai/Handler/Warp/Windows.hs.html">Windows.hs</a></div></div></div><div class="node-path"><a class="file" href="../../../../warp/Network/Wai/Handler/Warp.hs.html">Warp.hs</a></div></div></div></div></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> test</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../warp/test/ConduitSpec.hs.html">ConduitSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/ExceptionSpec.hs.html">ExceptionSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/FdCacheSpec.hs.html">FdCacheSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/MultiMapSpec.hs.html">MultiMapSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/ReadIntSpec.hs.html">ReadIntSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/RequestSpec.hs.html">RequestSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/ResponseHeaderSpec.hs.html">ResponseHeaderSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/ResponseSpec.hs.html">ResponseSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/RunSpec.hs.html">RunSpec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/Spec.hs.html">Spec.hs</a></div><div class="node-path"><a class="file" href="../../warp/test/doctests.hs.html">doctests.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> bench</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../warp/bench/Parser.hs.html">Parser.hs</a></div></div></div><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> attic</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../warp/attic/bigtable-single.hs.html">bigtable-single.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/bigtable-stream.hs.html">bigtable-stream.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/file-nolen.hs.html">file-nolen.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/file.hs.html">file.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/pong.hs.html">pong.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/print-post.hs.html">print-post.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/readInt.hs.html">readInt.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/runtests.hs.html">runtests.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/server-no-keepalive.hs.html">server-no-keepalive.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/statuses.hs.html">statuses.hs</a></div><div class="node-path"><a class="file" href="../../warp/attic/undrained.hs.html">undrained.hs</a></div></div></div><div class="node-path"><a class="file" href="../warp/Setup.lhs.html">Setup.lhs</a></div></div></div><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> warp-tls</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> Network</div>
<div class="node-body"><div class="node" level=3><div class="node-title"><i class="fa fa-angle-right carrot"></i> Wai</div>
<div class="node-body"><div class="node" level=4><div class="node-title"><i class="fa fa-angle-right carrot"></i> Handler</div>
<div class="node-body"><div class="node-path"><a class="file" href="../../../../warp-tls/Network/Wai/Handler/WarpTLS.hs.html">WarpTLS.hs</a></div></div></div></div></div></div></div><div class="node-path"><a class="file" href="../warp-tls/Setup.lhs.html">Setup.lhs</a></div><div class="node-path"><a class="file" href="../warp-tls/graceful-pong.hs.html">graceful-pong.hs</a></div><div class="node-path"><a class="file" href="../warp-tls/pong.hs.html">pong.hs</a></div></div></div></div></div>
      </div>
      <div id="defs-toc" class="toc">
        <div class="node" level=0><div class="node-title"><i class="fa fa-angle-right carrot"></i> all defs</div>
<div class="node-body"><div class="node" level=1><div class="node-title"><i class="fa fa-angle-right carrot"></i> wai-app-static</div>
<div class="node-body"><div class="node" level=2><div class="node-title"><i class="fa fa-angle-right carrot"></i> WaiAppStatic</div>
<div class="node-body"><div class="node-path"><a class="def" href="../../wai-app-static/WaiAppStatic/Listing.hs.html#wai-app-static/wai-app-static/WaiAppStatic/Listing">Listing</a> - Module</div></div></div></div></div></div></div>
      </div>
    </div>
    <div class="grid">
      
      <div class="row">
        <div class="doc">&nbsp;</div>
        <div class="code"><span class="def" id="wai-app-static/wai-app-static/WaiAppStatic/Listing"></span><span class="pun">{</span><span class="pun">-</span><span class="pun">#</span> <span class="typ">LANGUAGE</span> <span class="typ">CPP</span> <span class="pun">#</span><span class="pun">-</span><span class="pun">}</span>
<span class="pun">{</span><span class="pun">-</span><span class="pun">#</span> <span class="typ">LANGUAGE</span> <span class="typ">OverloadedStrings</span> <span class="pun">#</span><span class="pun">-</span><span class="pun">}</span>
<span class="kwd">module</span> <span class="typ">WaiAppStatic</span><span class="pun">.</span><span class="typ">Listing</span>
    <span class="pun">(</span> <span class="pln">defaultListing</span>
    <span class="pun">)</span> <span class="kwd">where</span>

<span class="kwd">import</span> <span class="pln">qualified</span> <span class="typ">Text</span><span class="pun">.</span><span class="typ">Blaze</span><span class="pun">.</span><span class="typ">Html5</span><span class="pun">.</span><span class="typ">Attributes</span> <span class="kwd">as</span> <span class="typ">A</span>
<span class="kwd">import</span> <span class="pln">qualified</span> <span class="typ">Text</span><span class="pun">.</span><span class="typ">Blaze</span><span class="pun">.</span><span class="typ">Html5</span>            <span class="kwd">as</span> <span class="typ">H</span>
<span class="kwd">import</span>           <span class="typ">Text</span><span class="pun">.</span><span class="typ">Blaze</span>                  <span class="pun">(</span><span class="pun">(</span><span class="pun">!</span><span class="pun">)</span><span class="pun">)</span>
<span class="kwd">import</span> <span class="pln">qualified</span> <span class="typ">Data</span><span class="pun">.</span><span class="typ">Text</span> <span class="kwd">as</span> <span class="typ">T</span>
<span class="kwd">import</span> <span class="typ">Data</span><span class="pun">.</span><span class="typ">Time</span>
<span class="kwd">import</span> <span class="typ">Data</span><span class="pun">.</span><span class="typ">Time</span><span class="pun">.</span><span class="typ">Clock</span><span class="pun">.</span><span class="typ">POSIX</span>
<span class="kwd">import</span> <span class="typ">WaiAppStatic</span><span class="pun">.</span><span class="typ">Types</span>
<span class="pun">#</span><span class="kwd">if</span> <span class="pun">!</span><span class="typ">MIN_VERSION_time</span><span class="pun">(</span><span class="dec">1</span><span class="pun">,</span><span class="dec">5</span><span class="pun">,</span><span class="dec">0</span><span class="pun">)</span>
<span class="kwd">import</span> <span class="typ">System</span><span class="pun">.</span><span class="typ">Locale</span> <span class="pun">(</span><span class="pln">defaultTimeLocale</span><span class="pun">)</span>
<span class="pun">#</span><span class="pln">endif</span>
<span class="kwd">import</span> <span class="typ">Data</span><span class="pun">.</span><span class="typ">List</span> <span class="pun">(</span><span class="pln">sortBy</span><span class="pun">)</span>
<span class="kwd">import</span> <span class="typ">Util</span>

<span class="kwd">import</span> <span class="pln">qualified</span> <span class="typ">Text</span><span class="pun">.</span><span class="typ">Blaze</span><span class="pun">.</span><span class="typ">Html</span><span class="pun">.</span><span class="typ">Renderer</span><span class="pun">.</span><span class="typ">Utf8</span> <span class="kwd">as</span> <span class="typ">HU</span>

<span class="pun">-</span><span class="pun">-</span> <span class="pun">|</span> <span class="typ">Provides</span> <span class="pln">a</span> <span class="kwd">default</span> <span class="pln">directory</span> <span class="pln">listing</span><span class="pun">,</span> <span class="pln">suitable</span> <span class="kwd">for</span> <span class="pln">most</span> <span class="pln">apps</span><span class="pun">.</span>
<span class="pun">-</span><span class="pun">-</span>
<span class="pun">-</span><span class="pun">-</span> <span class="typ">Code</span> <span class="pln">below</span> <span class="pln">taken</span> <span class="kwd">from</span> <span class="typ">Happstack</span><span class="pun">:</span> <span class="pun">&lt;</span><span class="pln">http</span><span class="pun">:</span><span class="com">//patch-tag.com/r/mae/happstack/snapshot/current/content/pretty/happstack-server/src/Happstack/Server/FileServe/BuildingBlocks.hs&gt;</span>
<span class="pln">defaultListing</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">Listing</span>
<span class="pln">defaultListing</span> <span class="pln">pieces</span> <span class="pun">(</span><span class="typ">Folder</span> <span class="pln">contents</span><span class="pun">)</span> <span class="pun">=</span> <span class="kwd">do</span>
    <span class="pln">let</span> <span class="pln">isTop</span> <span class="pun">=</span> <span class="kwd">null</span> <span class="pln">pieces</span> <span class="pun">|</span><span class="pun">|</span> <span class="kwd">map</span> <span class="typ">Just</span> <span class="pln">pieces</span> <span class="pun">=</span><span class="pun">=</span> <span class="pun">[</span><span class="pln">toPiece</span> <span class="str">&#34;&#34;</span><span class="pun">]</span>
    <span class="pln">let</span> <span class="pln">fps</span><span class="str">&#39;&#39;</span> <span class="pun">:</span><span class="pun">:</span> <span class="pun">[</span><span class="typ">Either</span> <span class="typ">FolderName</span> <span class="typ">File</span><span class="pun">]</span>
        <span class="pln">fps</span><span class="str">&#39;&#39;</span> <span class="pun">=</span> <span class="pun">(</span><span class="kwd">if</span> <span class="pln">isTop</span> <span class="kwd">then</span> <span class="pln">id</span> <span class="kwd">else</span> <span class="pun">(</span><span class="typ">Left</span> <span class="pun">(</span><span class="pln">unsafeToPiece</span> <span class="str">&#34;&#34;</span><span class="pun">)</span> <span class="pun">:</span><span class="pun">)</span><span class="pun">)</span> <span class="pln">contents</span> <span class="pun">-</span><span class="pun">-</span> <span class="typ">FIXME</span> <span class="pln">emptyParentFolder</span> <span class="pln">feels</span> <span class="pln">like</span> <span class="pln">a</span> <span class="pln">bit</span> <span class="pln">of</span> <span class="pln">a</span> <span class="pln">hack</span>
    <span class="kwd">return</span> <span class="pun">$</span> <span class="typ">HU</span><span class="pun">.</span><span class="pln">renderHtmlBuilder</span>
           <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">html</span> <span class="pun">$</span> <span class="kwd">do</span>
             <span class="typ">H</span><span class="pun">.</span><span class="pln">head</span> <span class="pun">$</span> <span class="kwd">do</span>
                 <span class="pln">let</span> <span class="pln">title</span> <span class="pun">=</span> <span class="typ">T</span><span class="pun">.</span><span class="pln">intercalate</span> <span class="str">&#34;/&#34;</span> <span class="pun">$</span> <span class="kwd">map</span> <span class="pln">fromPiece</span> <span class="pln">pieces</span>
                 <span class="pln">let</span> <span class="pln">title</span><span class="str">&#39; = if T.null title then &#34;root folder&#34; else title
</span>                 <span class="typ">H</span><span class="pun">.</span><span class="pln">title</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pln">title</span><span class="str">&#39;
</span>                 <span class="typ">H</span><span class="pun">.</span><span class="pln">style</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span> <span class="pln">unlines</span> <span class="pun">[</span> <span class="str">&#34;table { margin: 0 auto; width: 760px; border-collapse: collapse; font-family: &#39;sans-serif&#39;; }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;table, th, td { border: 1px solid #353948; }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;td.size { text-align: right; font-size: 0.7em; width: 50px }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;td.date { text-align: right; font-size: 0.7em; width: 130px }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;td { padding-right: 1em; padding-left: 1em; }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;th.first { background-color: white; width: 24px }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;td.first { padding-right: 0; padding-left: 0; text-align: center }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;tr { background-color: white; }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;tr.alt { background-color: #A3B5BA}&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;th { background-color: #3C4569; color: white; font-size: 1.125em; }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;h1 { width: 760px; margin: 1em auto; font-size: 1em; font-family: sans-serif }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;img { width: 20px }&#34;</span>
                                              <span class="pun">,</span> <span class="str">&#34;a { text-decoration: none }&#34;</span>
                                              <span class="pun">]</span>
             <span class="typ">H</span><span class="pun">.</span><span class="pln">body</span> <span class="pun">$</span> <span class="kwd">do</span>
                 <span class="typ">H</span><span class="pun">.</span><span class="pln">h1</span> <span class="pun">$</span> <span class="pln">showFolder</span> <span class="pun">$</span> <span class="pln">filter</span> <span class="pun">(</span><span class="kwd">not</span> <span class="pun">.</span> <span class="typ">T</span><span class="pun">.</span><span class="kwd">null</span> <span class="pun">.</span> <span class="pln">fromPiece</span><span class="pun">)</span> <span class="pln">pieces</span>
                 <span class="pln">renderDirectoryContentsTable</span> <span class="pln">haskellSrc</span> <span class="pln">folderSrc</span> <span class="pln">fps</span><span class="str">&#39;&#39;</span>
  <span class="kwd">where</span>
    <span class="pln">image</span> <span class="pln">x</span> <span class="pun">=</span> <span class="typ">T</span><span class="pun">.</span><span class="pln">unpack</span> <span class="pun">$</span> <span class="typ">T</span><span class="pun">.</span><span class="pln">concat</span> <span class="pun">[</span><span class="pun">(</span><span class="pln">relativeDirFromPieces</span> <span class="pln">pieces</span><span class="pun">)</span><span class="pun">,</span> <span class="str">&#34;.hidden/&#34;</span><span class="pun">,</span> <span class="pln">x</span><span class="pun">,</span> <span class="str">&#34;.png&#34;</span><span class="pun">]</span>
    <span class="pln">folderSrc</span> <span class="pun">=</span> <span class="pln">image</span> <span class="str">&#34;folder&#34;</span>
    <span class="pln">haskellSrc</span> <span class="pun">=</span> <span class="pln">image</span> <span class="str">&#34;haskell&#34;</span>
    <span class="pln">showName</span> <span class="str">&#34;&#34;</span> <span class="pun">=</span> <span class="str">&#34;root&#34;</span>
    <span class="pln">showName</span> <span class="pln">x</span> <span class="pun">=</span> <span class="pln">x</span>

    <span class="pln">showFolder</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">Pieces</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">H</span><span class="pun">.</span><span class="typ">Html</span>
    <span class="pln">showFolder</span> <span class="pun">[</span><span class="pun">]</span> <span class="pun">=</span> <span class="str">&#34;/&#34;</span>
    <span class="pln">showFolder</span> <span class="pun">[</span><span class="pln">x</span><span class="pun">]</span> <span class="pun">=</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span> <span class="pln">showName</span> <span class="pun">$</span> <span class="pln">fromPiece</span> <span class="pln">x</span>
    <span class="pln">showFolder</span> <span class="pun">(</span><span class="pln">x</span><span class="pun">:</span><span class="pln">xs</span><span class="pun">)</span> <span class="pun">=</span> <span class="kwd">do</span>
        <span class="pln">let</span> <span class="pln">href</span> <span class="pun">=</span> <span class="pln">concat</span> <span class="pun">$</span> <span class="pln">replicate</span> <span class="pun">(</span><span class="pln">length</span> <span class="pln">xs</span><span class="pun">)</span> <span class="str">&#34;../&#34;</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">String</span>
        <span class="typ">H</span><span class="pun">.</span><span class="pln">a</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">href</span> <span class="pun">(</span><span class="typ">H</span><span class="pun">.</span><span class="pln">toValue</span> <span class="pln">href</span><span class="pun">)</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span> <span class="pln">showName</span> <span class="pun">$</span> <span class="pln">fromPiece</span> <span class="pln">x</span>
        <span class="str">&#34; / &#34;</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">H</span><span class="pun">.</span><span class="typ">Html</span>
        <span class="pln">showFolder</span> <span class="pln">xs</span>

<span class="pun">-</span><span class="pun">-</span> <span class="pun">|</span> <span class="pln">a</span> <span class="kwd">function</span> <span class="pln">to</span> <span class="pln">generate</span> <span class="pln">an</span> <span class="typ">HTML</span> <span class="pln">table</span> <span class="pln">showing</span> <span class="pln">the</span> <span class="pln">contents</span> <span class="pln">of</span> <span class="pln">a</span> <span class="pln">directory</span> <span class="pln">on</span> <span class="pln">the</span> <span class="pln">disk</span>
<span class="pun">-</span><span class="pun">-</span>
<span class="pun">-</span><span class="pun">-</span> <span class="typ">This</span> <span class="kwd">function</span> <span class="pln">generates</span> <span class="pln">most</span> <span class="pln">of</span> <span class="pln">the</span> <span class="pln">content</span> <span class="pln">of</span> <span class="pln">the</span>
<span class="pun">-</span><span class="pun">-</span> <span class="str">&#39;renderDirectoryContents&#39;</span> <span class="pln">page</span><span class="pun">.</span> <span class="typ">If</span> <span class="pln">you</span> <span class="pln">want</span> <span class="pln">to</span> <span class="pln">style</span> <span class="pln">the</span> <span class="pln">page</span>
<span class="pun">-</span><span class="pun">-</span> <span class="pln">differently</span><span class="pun">,</span> <span class="kwd">or</span> <span class="pln">add</span> <span class="pln">google</span> <span class="pln">analytics</span> <span class="pln">code</span><span class="pun">,</span> <span class="pln">etc</span><span class="pun">,</span> <span class="pln">you</span> <span class="pln">can</span> <span class="pln">just</span> <span class="pln">create</span>
<span class="pun">-</span><span class="pun">-</span> <span class="pln">a</span> <span class="kwd">new</span> <span class="pln">page</span> <span class="kwd">template</span> <span class="pln">to</span> <span class="pln">wrap</span> <span class="pln">around</span> <span class="kwd">this</span> <span class="typ">HTML</span><span class="pun">.</span>
<span class="pun">-</span><span class="pun">-</span>
<span class="pun">-</span><span class="pun">-</span> <span class="pln">see</span> <span class="pln">also</span><span class="pun">:</span> <span class="str">&#39;getMetaData&#39;</span><span class="pun">,</span> <span class="str">&#39;renderDirectoryContents&#39;</span>
<span class="pln">renderDirectoryContentsTable</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">String</span>
                             <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">String</span>
                             <span class="pun">-</span><span class="pun">&gt;</span> <span class="pun">[</span><span class="typ">Either</span> <span class="typ">FolderName</span> <span class="typ">File</span><span class="pun">]</span>
                             <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">H</span><span class="pun">.</span><span class="typ">Html</span>
<span class="pln">renderDirectoryContentsTable</span> <span class="pln">haskellSrc</span> <span class="pln">folderSrc</span> <span class="pln">fps</span> <span class="pun">=</span>
           <span class="typ">H</span><span class="pun">.</span><span class="pln">table</span> <span class="pun">$</span> <span class="kwd">do</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">thead</span> <span class="pun">$</span> <span class="kwd">do</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">th</span> <span class="pun">!</span> <span class="pun">(</span><span class="typ">A</span><span class="pun">.</span><span class="pln">class_</span> <span class="str">&#34;first&#34;</span><span class="pun">)</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">img</span> <span class="pun">!</span> <span class="pun">(</span><span class="typ">A</span><span class="pun">.</span><span class="pln">src</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toValue</span> <span class="pln">haskellSrc</span><span class="pun">)</span>
                                     <span class="typ">H</span><span class="pun">.</span><span class="pln">th</span> <span class="str">&#34;Name&#34;</span>
                                     <span class="typ">H</span><span class="pun">.</span><span class="pln">th</span> <span class="str">&#34;Modified&#34;</span>
                                     <span class="typ">H</span><span class="pun">.</span><span class="pln">th</span> <span class="str">&#34;Size&#34;</span>
                        <span class="typ">H</span><span class="pun">.</span><span class="pln">tbody</span> <span class="pun">$</span> <span class="pln">mapM_</span> <span class="pln">mkRow</span> <span class="pun">(</span><span class="pln">zip</span> <span class="pun">(</span><span class="pln">sortBy</span> <span class="pln">sortMD</span> <span class="pln">fps</span><span class="pun">)</span> <span class="pun">$</span> <span class="pln">cycle</span> <span class="pun">[</span><span class="kwd">False</span><span class="pun">,</span> <span class="kwd">True</span><span class="pun">]</span><span class="pun">)</span>
    <span class="kwd">where</span>
      <span class="pln">sortMD</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">Either</span> <span class="typ">FolderName</span> <span class="typ">File</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">Either</span> <span class="typ">FolderName</span> <span class="typ">File</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">Ordering</span>
      <span class="pln">sortMD</span> <span class="typ">Left</span><span class="pun">{</span><span class="pun">}</span> <span class="typ">Right</span><span class="pun">{</span><span class="pun">}</span> <span class="pun">=</span> <span class="typ">LT</span>
      <span class="pln">sortMD</span> <span class="typ">Right</span><span class="pun">{</span><span class="pun">}</span> <span class="typ">Left</span><span class="pun">{</span><span class="pun">}</span> <span class="pun">=</span> <span class="typ">GT</span>
      <span class="pln">sortMD</span> <span class="pun">(</span><span class="typ">Left</span> <span class="pln">a</span><span class="pun">)</span> <span class="pun">(</span><span class="typ">Left</span> <span class="pln">b</span><span class="pun">)</span> <span class="pun">=</span> <span class="pln">compare</span> <span class="pln">a</span> <span class="pln">b</span>
      <span class="pln">sortMD</span> <span class="pun">(</span><span class="typ">Right</span> <span class="pln">a</span><span class="pun">)</span> <span class="pun">(</span><span class="typ">Right</span> <span class="pln">b</span><span class="pun">)</span> <span class="pun">=</span> <span class="pln">compare</span> <span class="pun">(</span><span class="pln">fileName</span> <span class="pln">a</span><span class="pun">)</span> <span class="pun">(</span><span class="pln">fileName</span> <span class="pln">b</span><span class="pun">)</span>

      <span class="pln">mkRow</span> <span class="pun">:</span><span class="pun">:</span> <span class="pun">(</span><span class="typ">Either</span> <span class="typ">FolderName</span> <span class="typ">File</span><span class="pun">,</span> <span class="typ">Bool</span><span class="pun">)</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">H</span><span class="pun">.</span><span class="typ">Html</span>
      <span class="pln">mkRow</span> <span class="pun">(</span><span class="pln">md</span><span class="pun">,</span> <span class="pln">alt</span><span class="pun">)</span> <span class="pun">=</span>
          <span class="pun">(</span><span class="kwd">if</span> <span class="pln">alt</span> <span class="kwd">then</span> <span class="pun">(</span><span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">class_</span> <span class="str">&#34;alt&#34;</span><span class="pun">)</span> <span class="kwd">else</span> <span class="pln">id</span><span class="pun">)</span> <span class="pun">$</span>
          <span class="typ">H</span><span class="pun">.</span><span class="pln">tr</span> <span class="pun">$</span> <span class="kwd">do</span>
                   <span class="typ">H</span><span class="pun">.</span><span class="pln">td</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">class_</span> <span class="str">&#34;first&#34;</span>
                        <span class="pun">$</span> <span class="kwd">case</span> <span class="pln">md</span> <span class="pln">of</span>
                            <span class="typ">Left</span><span class="pun">{</span><span class="pun">}</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">img</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">src</span> <span class="pun">(</span><span class="typ">H</span><span class="pun">.</span><span class="pln">toValue</span> <span class="pln">folderSrc</span><span class="pun">)</span>
                                            <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">alt</span> <span class="str">&#34;Folder&#34;</span>
                            <span class="typ">Right</span><span class="pun">{</span><span class="pun">}</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="kwd">return</span> <span class="pun">(</span><span class="pun">)</span>
                   <span class="pln">let</span> <span class="pln">name</span> <span class="pun">=</span> <span class="pln">either</span> <span class="pln">id</span> <span class="pln">fileName</span> <span class="pln">md</span>
                   <span class="pln">let</span> <span class="pln">isFile</span> <span class="pun">=</span> <span class="pln">either</span> <span class="pun">(</span><span class="kwd">const</span> <span class="kwd">False</span><span class="pun">)</span> <span class="pun">(</span><span class="kwd">const</span> <span class="kwd">True</span><span class="pun">)</span> <span class="pln">md</span>
                   <span class="typ">H</span><span class="pun">.</span><span class="pln">td</span> <span class="pun">(</span><span class="typ">H</span><span class="pun">.</span><span class="pln">a</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">href</span> <span class="pun">(</span><span class="typ">H</span><span class="pun">.</span><span class="pln">toValue</span> <span class="pun">$</span> <span class="pln">fromPiece</span> <span class="pln">name</span> <span class="str">`T.append`</span> <span class="kwd">if</span> <span class="pln">isFile</span> <span class="kwd">then</span> <span class="str">&#34;&#34;</span> <span class="kwd">else</span> <span class="str">&#34;/&#34;</span><span class="pun">)</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span> <span class="pln">fromPiece</span> <span class="pln">name</span><span class="pun">)</span>
                   <span class="typ">H</span><span class="pun">.</span><span class="pln">td</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">class_</span> <span class="str">&#34;date&#34;</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span>
                       <span class="kwd">case</span> <span class="pln">md</span> <span class="pln">of</span>
                           <span class="typ">Right</span> <span class="typ">File</span> <span class="pun">{</span> <span class="pln">fileGetModified</span> <span class="pun">=</span> <span class="typ">Just</span> <span class="pln">t</span> <span class="pun">}</span> <span class="pun">-</span><span class="pun">&gt;</span>
                                   <span class="pln">formatCalendarTime</span> <span class="pln">defaultTimeLocale</span> <span class="str">&#34;%d-%b-%Y %X&#34;</span> <span class="pln">t</span>
                           <span class="pln">_</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="str">&#34;&#34;</span>
                   <span class="typ">H</span><span class="pun">.</span><span class="pln">td</span> <span class="pun">!</span> <span class="typ">A</span><span class="pun">.</span><span class="pln">class_</span> <span class="str">&#34;size&#34;</span> <span class="pun">$</span> <span class="typ">H</span><span class="pun">.</span><span class="pln">toHtml</span> <span class="pun">$</span>
                       <span class="kwd">case</span> <span class="pln">md</span> <span class="pln">of</span>
                           <span class="typ">Right</span> <span class="typ">File</span> <span class="pun">{</span> <span class="pln">fileGetSize</span> <span class="pun">=</span> <span class="pln">s</span> <span class="pun">}</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="pln">prettyShow</span> <span class="pln">s</span>
                           <span class="typ">Left</span><span class="pun">{</span><span class="pun">}</span> <span class="pun">-</span><span class="pun">&gt;</span> <span class="str">&#34;&#34;</span>
      <span class="pln">formatCalendarTime</span> <span class="pln">a</span> <span class="pln">b</span> <span class="pln">c</span> <span class="pun">=</span>  <span class="pln">formatTime</span> <span class="pln">a</span> <span class="pln">b</span> <span class="pun">$</span> <span class="pln">posixSecondsToUTCTime</span> <span class="pun">(</span><span class="pln">realToFrac</span> <span class="pln">c</span> <span class="pun">:</span><span class="pun">:</span> <span class="typ">POSIXTime</span><span class="pun">)</span>
      <span class="pln">prettyShow</span> <span class="pln">x</span>
        <span class="pun">|</span> <span class="pln">x</span> <span class="pun">&gt;</span> <span class="dec">1024</span> <span class="pun">=</span> <span class="pln">prettyShowK</span> <span class="pun">$</span> <span class="pln">x</span> <span class="str">`div`</span> <span class="dec">1024</span>
        <span class="pun">|</span> <span class="pln">otherwise</span> <span class="pun">=</span> <span class="pln">addCommas</span> <span class="str">&#34;B&#34;</span> <span class="pln">x</span>
      <span class="pln">prettyShowK</span> <span class="pln">x</span>
        <span class="pun">|</span> <span class="pln">x</span> <span class="pun">&gt;</span> <span class="dec">1024</span> <span class="pun">=</span> <span class="pln">prettyShowM</span> <span class="pun">$</span> <span class="pln">x</span> <span class="str">`div`</span> <span class="dec">1024</span>
        <span class="pun">|</span> <span class="pln">otherwise</span> <span class="pun">=</span> <span class="pln">addCommas</span> <span class="str">&#34;KB&#34;</span> <span class="pln">x</span>
      <span class="pln">prettyShowM</span> <span class="pln">x</span>
        <span class="pun">|</span> <span class="pln">x</span> <span class="pun">&gt;</span> <span class="dec">1024</span> <span class="pun">=</span> <span class="pln">prettyShowG</span> <span class="pun">$</span> <span class="pln">x</span> <span class="str">`div`</span> <span class="dec">1024</span>
        <span class="pun">|</span> <span class="pln">otherwise</span> <span class="pun">=</span> <span class="pln">addCommas</span> <span class="str">&#34;MB&#34;</span> <span class="pln">x</span>
      <span class="pln">prettyShowG</span> <span class="pln">x</span> <span class="pun">=</span> <span class="pln">addCommas</span> <span class="str">&#34;GB&#34;</span> <span class="pln">x</span>
      <span class="pln">addCommas</span> <span class="pln">s</span> <span class="pun">=</span> <span class="pun">(</span><span class="pun">+</span><span class="pun">+</span> <span class="pun">(</span><span class="str">&#39; &#39;</span> <span class="pun">:</span> <span class="pln">s</span><span class="pun">)</span><span class="pun">)</span> <span class="pun">.</span> <span class="pln">reverse</span> <span class="pun">.</span> <span class="pln">addCommas</span><span class="str">&#39; . reverse . show
</span>      <span class="pln">addCommas</span><span class="str">&#39; (a:b:c:d:e) = a : b : c : &#39;</span><span class="pun">,</span><span class="str">&#39; : addCommas&#39;</span> <span class="pun">(</span><span class="pln">d</span> <span class="pun">:</span> <span class="pln">e</span><span class="pun">)</span>
      <span class="pln">addCommas</span><span class="str">&#39; x = x
</span></div>
      </div>
      
    </div>
  </body>
</html>
